# Vulnerability Scanning Flow

This document outlines the vulnerability scanning flow implemented in the Surakshit AI system, which integrates with industry-standard scanning tools like OWASP ZAP.

## Scanning Process Overview

The scanning process involves several steps, from selecting a scan profile to processing and displaying the results.

```mermaid
graph TD
    A[Start Scan] --> B{Select Scan Source}
    B -->|Upload Codebase| C[Process Uploaded Files]
    B -->|GitHub Repository| D[Clone Repository]
    C --> E[Select Scan Profile]
    D --> E
    E --> F[Configure Scan Parameters]
    F --> G[Initialize Scanning Tool]
    G --> H[Execute Scan]
    H --> I{Scan Type}
    I -->|Passive Scan| J[Run Passive Scanners]
    I -->|Active Scan| K[Run Active Scanners]
    I -->|Full Scan| L[Run Both Passive & Active]
    J --> M[Collect Results]
    K --> M
    L --> M
    M --> N[Process & Standardize Results]
    N --> O[Store Results]
    O --> P[Display Results in Dashboard]
```

## OWASP ZAP Integration Flow

The system integrates with OWASP ZAP for vulnerability scanning, following this process:

```mermaid
sequenceDiagram
    participant User
    participant Frontend
    participant Backend
    participant ZAP
    
    User->>Frontend: Select scan profile & target
    Frontend->>Backend: Request scan
    Backend->>ZAP: Initialize session
    ZAP-->>Backend: Session created
    Backend->>ZAP: Configure scanners based on profile
    ZAP-->>Backend: Configuration applied
    Backend->>ZAP: Start spider scan
    ZAP-->>Backend: Spider scan started
    
    loop Check Status
        Backend->>ZAP: Check spider status
        ZAP-->>Backend: Status update
    end
    
    alt AJAX Spider Enabled
        Backend->>ZAP: Start AJAX spider
        ZAP-->>Backend: AJAX spider started
        
        loop Check Status
            Backend->>ZAP: Check AJAX spider status
            ZAP-->>Backend: Status update
        end
    end
    
    alt Active Scan Enabled
        Backend->>ZAP: Start active scan
        ZAP-->>Backend: Active scan started
        
        loop Check Status
            Backend->>ZAP: Check active scan status
            ZAP-->>Backend: Status update
        end
    end
    
    Backend->>ZAP: Get scan results
    ZAP-->>Backend: Return alerts
    Backend->>Backend: Standardize results
    Backend-->>Frontend: Return processed results
    Frontend-->>User: Display vulnerability report
```

## Scan Profiles and Configuration

The system supports multiple scanning profiles for different project types, with configurable parameters:

```mermaid
classDiagram
    class ScanProfile {
        +String name
        +String description
        +ScanParameters params
    }
    
    class ScanParameters {
        +String threshold
        +Number maxDuration
        +Number maxDepth
        +Boolean includePassive
        +Boolean includeActive
        +Number spiderScanMaxDuration
        +Boolean ajaxSpider
        +Boolean apiScan
        +Array scanners
        +Array excludeUrls
    }
    
    class WebAppProfile {
        +name = "Web Application"
        +description = "Comprehensive scan for web applications"
    }
    
    class APIProfile {
        +name = "API"
        +description = "Focused scan for REST APIs"
    }
    
    class MobileBackendProfile {
        +name = "Mobile Backend"
        +description = "Security scan for mobile app backends"
    }
    
    class EcommerceProfile {
        +name = "E-commerce"
        +description = "Specialized scan for e-commerce applications"
    }
    
    class QuickProfile {
        +name = "Quick Scan"
        +description = "Fast scan with limited scope"
    }
    
    class ThoroughProfile {
        +name = "Thorough Scan"
        +description = "Comprehensive scan with all available scanners"
    }
    
    ScanProfile <|-- WebAppProfile
    ScanProfile <|-- APIProfile
    ScanProfile <|-- MobileBackendProfile
    ScanProfile <|-- EcommerceProfile
    ScanProfile <|-- QuickProfile
    ScanProfile <|-- ThoroughProfile
    ScanProfile *-- ScanParameters
```

## Vulnerability Processing Flow

Once vulnerabilities are detected, they are processed and standardized for further analysis:

```mermaid
graph TD
    A[Raw Scan Results] --> B[Extract Vulnerability Data]
    B --> C[Map Severity Levels]
    C --> D[Standardize Format]
    D --> E[Add Metadata]
    E --> F[Store in Database]
    F --> G{Remediation?}
    G -->|Yes| H[Send to AI Module]
    G -->|No| I[Display in Dashboard]
    H --> J[Generate Fix Recommendations]
    J --> K[Apply Fixes]
    K --> L[Verify Fixes]
    L --> I
```

## User Interface Flow

The user interface flow for vulnerability scanning:

```mermaid
graph TD
    A[Dashboard] --> B{Select Source}
    B -->|Upload| C[Upload Codebase]
    B -->|GitHub| D[Connect to GitHub]
    C --> E[Select Scan Profile]
    D --> E
    E --> F[Configure Scan]
    F --> G[Start Scan]
    G --> H[View Progress]
    H --> I[View Results]
    I --> J{Actions}
    J -->|View Details| K[Vulnerability Details]
    J -->|Auto-fix| L[AI Remediation]
    J -->|Export| M[Export Report]
    K --> N[View Code Context]
    L --> O[Apply Fixes]
    O --> P[Verify Fixes]
```

## Conclusion

The vulnerability scanning flow in Surakshit AI provides a comprehensive approach to identifying security issues in applications. By integrating with industry-standard tools like OWASP ZAP and supporting multiple scanning profiles, the system offers flexibility and thoroughness in security assessments.